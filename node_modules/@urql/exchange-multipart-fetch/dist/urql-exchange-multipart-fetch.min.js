var e=require("wonka"),r=require("extract-files"),n=require("@urql/core/internal");function t(){return(t=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}exports.multipartFetchExchange=function(a){var i=a.forward;return function(a){var o=e.share(a),u=e.mergeMap((function(a){var i,u,c=e.filter((function(e){return"teardown"===e.kind&&e.key===a.key}))(o),f=r.extractFiles(t({},a.variables)),p=f.files,s=n.makeFetchBody({query:a.query,variables:f.clone});if(p.size){i=n.makeFetchURL(a),"application/json"===(u=n.makeFetchOptions(a)).headers["content-type"]&&delete u.headers["content-type"],u.method="POST",u.body=new FormData,u.body.append("operations",JSON.stringify(s));var l={},d=0;p.forEach((function(e){l[++d]=e.map((function(e){return"variables."+e}))})),u.body.append("map",JSON.stringify(l)),d=0,p.forEach((function(e,r){u.body.append(""+ ++d,r,r.name)}))}else u=n.makeFetchOptions(a,s),i=n.makeFetchURL(a,s);return e.onPush((function(e){}))(e.takeUntil(c)(n.makeFetchSource(a,i,u)))}))(e.filter((function(e){return"query"===e.kind||"mutation"===e.kind}))(o)),c=i(e.filter((function(e){return"query"!==e.kind&&"mutation"!==e.kind}))(o));return e.merge([u,c])}};
//# sourceMappingURL=urql-exchange-multipart-fetch.min.js.map
